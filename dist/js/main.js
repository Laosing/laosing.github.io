"use strict";(new function(){var s=this,t=$(".main"),i=$("body"),l=$(".work"),n=$(".close"),e=$(".side"),r=$(".helper"),o=$(".about"),f=$("#work-container"),u=$("#timeline"),a=$(".bg");function c(n,e){n=n?"hidden":"",1<e.length?$(e).each(function(e,t){t.css({overflow:n})}):$(e).css({overflow:n})}this.init=function(){var o=document.title;page("*",function(e,t){var n=e.path.split("/"),i=n[n.length-1]?"Drew Rattana | "+function(e){return e.toLowerCase().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" ")}(n[n.length-1].replace(/-/g," ")):o;document.title=i,ga("set","page",e.path),ga("send","pageview"),gtag("config","UA-36735939-1",{page_path:e.path}),t()}),page("/",function(){s.aboutClose(),s.close()}),page("/about",function(){s.close(),s.aboutOpen()}),page("/work",function(){s.aboutClose(),s.checkMobile()?s.close():s.hide(0),i.hasClass("open-work")||s.open()}),page("/work/:title",function(n){s.aboutClose();var e=u.find("li[data-timeline-title=".concat(n.params.title,"]"));i.hasClass("open-work")&&e.hasClass("active")||s.open(function(){var e=u.find("li[data-timeline-title=".concat(n.params.title,"]")),t=f.find("li[data-work-title=".concat(n.params.title,"]"));s.next("next",t,e),r.removeClass("helper-active")})}),page({hashbang:!0}),$("#checkout").click(function(e){e.preventDefault(),page("/work")}),n.add(a).click(function(e){e.preventDefault(),s.checkMobile()&&l.hasClass("open")?page("/work"):page("/")}),$("#about-me").click(function(e){e.preventDefault(),page("/about")}),$(".about-close").click(function(e){e.preventDefault(),page("/")}),$(document).keydown(function(e){27==e.keyCode&&(i.hasClass("open-about")||i.hasClass("open-work"))&&page("/")});var c=tippy("[title]");tippy.browser.onUserInputChange=function(e){var t="touch"===e?"disable":"enable",n=!0,i=!1,o=void 0;try{for(var a,l=c.tooltips[Symbol.iterator]();!(n=(a=l.next()).done);n=!0)a.value[t]()}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}},window.addEventListener("scroll",function(){var e=!0,t=!1,n=void 0;try{for(var i,o=document.querySelectorAll(".tippy-popper")[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value._tippy;a.state.visible&&(a.popperInstance.disableEventListeners(),a.hide())}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}),$(".backtotop").on("click",function(e){e.preventDefault();var t=$(this).parents(".work-piece.active");$(this).velocity("scroll",{container:t,duration:2e3,offset:-t[0].scrollHeight,easing:"easeInOutCubic"})})},this.open=function(e){s.checkMobile()||a.show(),i.hasClass("open-work")?"function"==typeof e&&e():(i.addClass("open-work"),r.addClass("helper-active"),t.velocity({left:this.checkMobile()?"-100%":"-30%"},"normal","ease",function(){n.velocity("fadeIn","fast"),s.checkMobile()||l.velocity("fadeIn","normal"),"function"==typeof e&&e()}))},this.close=function(){if(a.velocity("fadeOut",function(){$(this).removeAttr("style")}),this.checkMobile()&&l.hasClass("open"))return s.hide(0),void l.velocity("fadeOut").removeClass("open");i.hasClass("open-work")&&(i.removeClass("open-work"),l.velocity("fadeOut","normal",function(){t.velocity({left:""},"normal","ease",function(){f.find("li.active").removeClass("active").removeAttr("style").hide(),$(".active").removeClass("active"),r.removeAttr("style"),l.removeClass("open")})}),n.velocity("fadeOut","fast"))},this.aboutOpen=function(){c(!0,[i,o]),i.addClass("open-about"),this.checkMobile()?o.velocity({scale:1},0).velocity("fadeIn",function(){c(!1,$(this))}):(e.velocity({opacity:1},{display:"none",duration:0}),t.velocity({scale:.9},function(){o.show().velocity({opacity:1},"linear",function(){c(!1,o)})}))},this.aboutClose=function(){c(!0,[i,o]),i.hasClass("open-about")&&(i.removeClass("open-about"),this.checkMobile()?o.velocity("fadeOut",function(){i.removeAttr("style")}):o.velocity({opacity:0},{easing:"linear",display:"none",complete:function(){t.velocity({scale:1},"linear",function(){e.velocity({opacity:1},{display:"block"}),i.removeAttr("style")})}}))},this.checkMobile=function(){return!!Modernizr.mq("only screen and (max-width: 600px)")},this.setHtml=function(){$.getJSON("./data/portfolio.json").fail(function(){alert("Sorry, this site is currently down. Please blame the developer and try again later. :(")}).done(function(e){s.json=e,Handlebars.registerHelper("hyphencase",function(e){return e.replace(/\W+/g,"-").toLowerCase()});var t=$("#work-template").html(),n=Handlebars.compile(t);f.html(n(e));var i=$("#list-template").html(),o=Handlebars.compile(i);u.html(o(e))}).done(function(){s.timelineArray=u.find("li"),s.workArray=f.find("li"),s.setLogic(),$(".work-piece").each(function(e){$(this).find("img.lazy:first").lazyload({event:"first"+e})})}).done(function(){s.init()})},this.setLogic=function(){this.timelineArray.length,this.timelineArray.each(function(e,t){var n=$(s.workArray[e]);n.find("img.lazy").lazyload({effect:"fadeIn",container:n}),$(t).click(function(){$(".velocity-animating").length||s.next("next",n,$(this),!0)})}),$(".next").click(function(e){e.preventDefault(),s.nextLogic($(this),"next")}),$(".prev").click(function(e){e.preventDefault(),s.nextLogic($(this),"prev")})},this.nextLogic=function(e,t){var n=(e=e.closest(".work-piece")).data("work"),i=s.timelineArray.length-1,o="next"===t?e.next():e.prev(),a=n<s.workArray.length-1?n+1:0,l=0!==n?n-1:s.workArray.length-1,c="next"===t?a:l,r=$(u.find("li")[c]);"next"===t&&n===s.workArray.length-1&&(o=f.find('li[data-work="0"]')),"prev"===t&&0===n&&(o=f.find('li[data-work="'+i+'"]')),s.next(t,o,r,!0)},this.hide=function(e,t){f.find(".active").velocity({left:e,opacity:1},"normal","ease",function(){$(".active").removeAttr("style").removeClass("active"),$(this).hide(),"function"==typeof t&&t()})},this.next=function(e,t,n,i){if(!t.hasClass("active"))if(this.checkMobile()&&(l.velocity("fadeIn",{duration:0}),r.hide()),t.find("img.lazy:first-child").trigger("first".concat(t.data("work"))),$(".active").length){var o="next"===e?"-200%":"100%";s.hide(o,a)}else a();function a(){t.addClass("active"),n.addClass("active"),l.addClass("open"),"prev"===e&&t.velocity({left:"-200%"},0),t.show().velocity({left:0},"normal","ease",function(){i&&page("/work/".concat(t.data("work-title")))})}}}).setHtml();