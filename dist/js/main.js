"use strict";(new function(){var r=this,t=$(".main"),o=$("body"),l=$(".work"),i=$(".close"),e=$(".side"),c=$(".helper"),n=$(".about"),f=$("#work-container"),u=$("#timeline"),a=$(".bg");function s(i,e){i=i?"hidden":"",1<e.length?$(e).each(function(e,t){t.css({overflow:i})}):$(e).css({overflow:i})}this.init=function(){page("/",function(){r.aboutClose(),r.close()}),page("/about",function(){r.close(),r.aboutOpen()}),page("/work",function(){r.aboutClose(),r.checkMobile()?r.close():r.hide(0),o.hasClass("open-work")||r.open()}),page("/work/:title",function(i){r.aboutClose();var e=u.find("li[data-timeline-title="+i.params.title+"]");o.hasClass("open-work")&&e.hasClass("active")||r.open(function(){var e=u.find("li[data-timeline-title="+i.params.title+"]"),t=f.find("li[data-work-title="+i.params.title+"]");r.next("next",t,e),c.removeClass("helper-active")})}),page({hashbang:!0}),$("#checkout").click(function(e){e.preventDefault(),page("/work")}),i.add(a).click(function(e){e.preventDefault(),r.checkMobile()&&l.hasClass("open")?page("/work"):page("/")}),$("#about-me").click(function(e){e.preventDefault(),page("/about")}),$(".about-close").click(function(e){e.preventDefault(),page("/")}),$(document).keydown(function(e){27==e.keyCode&&(o.hasClass("open-about")||o.hasClass("open-work"))&&page("/")}),tippy("[title]"),$(".backtotop").on("click",function(e){e.preventDefault();var t=$(this).parents(".work-piece.active");$(this).velocity("scroll",{container:t,duration:2e3,offset:-t[0].scrollHeight,easing:"easeInOutCubic"})})},this.open=function(e){r.checkMobile()||a.show(),o.hasClass("open-work")?"function"==typeof e&&e():(o.addClass("open-work"),c.addClass("helper-active"),t.velocity({left:this.checkMobile()?"-100%":"-30%"},"normal","ease",function(){i.velocity("fadeIn","fast"),r.checkMobile()||l.velocity("fadeIn","normal"),"function"==typeof e&&e()}))},this.close=function(){if(a.velocity("fadeOut",function(){$(this).removeAttr("style")}),this.checkMobile()&&l.hasClass("open"))return r.hide(0),void l.velocity("fadeOut").removeClass("open");o.hasClass("open-work")&&(o.removeClass("open-work"),l.velocity("fadeOut","normal",function(){t.velocity({left:""},"normal","ease",function(){f.find("li.active").removeClass("active").removeAttr("style").hide(),$(".active").removeClass("active"),c.removeAttr("style"),l.removeClass("open")})}),i.velocity("fadeOut","fast"))},this.aboutOpen=function(){s(!0,[o,n]),o.addClass("open-about"),this.checkMobile()?n.velocity({scale:1},0).velocity("fadeIn",function(){s(!1,$(this))}):(e.velocity({opacity:1},{display:"none",duration:0}),t.velocity({scale:.9},function(){n.show().velocity({opacity:1},"linear",function(){s(!1,n)})}))},this.aboutClose=function(){s(!0,[o,n]),o.hasClass("open-about")&&(o.removeClass("open-about"),this.checkMobile()?n.velocity("fadeOut",function(){o.removeAttr("style")}):n.velocity({opacity:0},{easing:"linear",display:"none",complete:function(){t.velocity({scale:1},"linear",function(){e.velocity({opacity:1},{display:"block"}),o.removeAttr("style")})}}))},this.checkMobile=function(){return!!Modernizr.mq("only screen and (max-width: 600px)")},this.setHtml=function(){$.getJSON("./data/portfolio.json").fail(function(){alert("Sorry, this site is currently down. Please blame the developer and try again later. :(")}).done(function(e){r.json=e,Handlebars.registerHelper("hyphencase",function(e){return e.replace(/\W+/g,"-").toLowerCase()});var t=$("#work-template").html(),i=Handlebars.compile(t);f.html(i(e));var o=$("#list-template").html(),n=Handlebars.compile(o);u.html(n(e))}).done(function(){r.timelineArray=u.find("li"),r.workArray=f.find("li"),r.setLogic(),$(".work-piece").each(function(e){$(this).find("img.lazy:first").lazyload({event:"first"+e})})}).done(function(){r.init()})},this.setLogic=function(){this.timelineArray.length,this.timelineArray.each(function(e,t){var i=$(r.workArray[e]);i.find("img.lazy").lazyload({effect:"fadeIn",container:i}),$(t).click(function(){$(".velocity-animating").length||r.next("next",i,$(this),!0)})}),$(".next").click(function(e){e.preventDefault(),r.nextLogic($(this),"next")}),$(".prev").click(function(e){e.preventDefault(),r.nextLogic($(this),"prev")})},this.nextLogic=function(e,t){var i=(e=e.closest(".work-piece")).data("work"),o=r.timelineArray.length-1,n="next"===t?e.next():e.prev(),a=i<r.workArray.length-1?i+1:0,l=0!==i?i-1:r.workArray.length-1,c="next"===t?a:l,s=$(u.find("li")[c]);"next"===t&&i===r.workArray.length-1&&(n=f.find('li[data-work="0"]')),"prev"===t&&0===i&&(n=f.find('li[data-work="'+o+'"]')),r.next(t,n,s,!0)},this.hide=function(e,t){f.find(".active").velocity({left:e,opacity:1},"normal","ease",function(){$(".active").removeAttr("style").removeClass("active"),$(this).hide(),"function"==typeof t&&t()})},this.next=function(e,t,i,o){if(!t.hasClass("active"))if(this.checkMobile()&&(l.velocity("fadeIn",{duration:0}),c.hide()),t.find("img.lazy:first-child").trigger("first"+t.data("work")),$(".active").length){var n="next"===e?"-200%":"100%";r.hide(n,a)}else a();function a(){t.addClass("active"),i.addClass("active"),l.addClass("open"),"prev"===e&&t.velocity({left:"-200%"},0),t.show().velocity({left:0},"normal","ease",function(){o&&page("/work/"+t.data("work-title"))})}}}).setHtml();